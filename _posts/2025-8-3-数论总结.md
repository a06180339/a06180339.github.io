---
layout: post
title: "猪猪的数论总结"
date:   2025-8-3
tags: ["数学", "数论", "总结", "7.2"]
comments: true
author: a06180339
---


- 小鸥定理与扩展小鸥定理
	- 小鸥定理：$a^{phi(m)} \equiv 1 \pmod m$，其中 $\gcd(m,a) = 1$
	- 扩展小鸥定理：$a^b \equiv a^{\varphi(m) + b \mod \varphi(m)} \pmod m$
	- 扩鸥定理应用：
		- 上帝与集合的正确用法扩展：求 $x$ 满足 $a^{a^{a^{a^{\cdots}}}} = x \pmod p$
		- $a^{x \mod \varphi(p) + \varphi(p)} = x$，递推即可。
		- 结论：$a^{a^{a^{a^{\cdots}}}}$ 只要递推 $O(\log p)$ 次即可求出
- BSGS
	- BSGS 是一种将 找答案分解成小步和大步的做法。（废话）
	- 流程（以求解 $a^x \equiv b \pmod p$ 为例子）：先将 x 拆成 $i \sqrt p + j$  。然后枚举 $i$ ，查找是否存在 $j$ 使得 $b a^j \equiv a^{i \sqrt p}$。如果存在，则 $x = i \sqrt p - j$ 是一组解。判断存不存在用哈希表即可。
- miller rabin & pollard rho
	- 二探定理：$p \in \text P$ 则 $x^2 = 1 \pmod p \Rightarrow x \equiv 1 \lor x \equiv -1 \pmod p$
	- 实例水母：

<pre class="cpp" style="font-family:monospace;"><span style="color: #0000ff;">bool</span> miller_rabin<span style="color: #008000;">&#40;</span>ll n, ll a<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
    ll d <span style="color: #000080;">=</span> n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, r <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">while</span> <span style="color: #008000;">&#40;</span><span style="color: #000040;">!</span><span style="color: #008000;">&#40;</span>d <span style="color: #000040;">&amp;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> d <span style="color: #000080;">&gt;&gt;=</span> <span style="color: #0000dd;">1</span>, r<span style="color: #000040;">++</span><span style="color: #008080;">;</span>
&nbsp;
    ll z <span style="color: #000080;">=</span> f_pow<span style="color: #008000;">&#40;</span>a, d, n<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>z <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span>
&nbsp;
        <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">for</span> <span style="color: #008000;">&#40;</span>ll i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> r<span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
        <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>z <span style="color: #000080;">==</span> n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span>
&nbsp;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
        z <span style="color: #000080;">=</span> <span style="color: #008000;">&#40;</span>z <span style="color: #000040;">*</span> z<span style="color: #008000;">&#41;</span> <span style="color: #000040;">%</span> n<span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #008000;">&#125;</span>
&nbsp;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
&nbsp;
<span style="color: #008000;">&#125;</span>
&nbsp;
&nbsp;
&nbsp;
<span style="color: #0000ff;">bool</span> prime<span style="color: #008000;">&#40;</span>ll n<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
    <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>n <span style="color: #000080;">&lt;=</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span>
&nbsp;
        <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">for</span> <span style="color: #008000;">&#40;</span>ll i <span style="color: #008080;">:</span> p2<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
        <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>n <span style="color: #000080;">==</span> i<span style="color: #008000;">&#41;</span>
&nbsp;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
        <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>n <span style="color: #000040;">%</span> i <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #008000;">&#41;</span>
&nbsp;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
&nbsp;
        <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #000040;">!</span>miller_rabin<span style="color: #008000;">&#40;</span>n, i<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span>
&nbsp;
            <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #008000;">&#125;</span>
&nbsp;
    <span style="color: #0000ff;">return</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
<span style="color: #008000;">&#125;</span>
&nbsp;
&nbsp;
&nbsp;
ll rho<span style="color: #008000;">&#40;</span>ll n<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
    ll x, y, z, c, g, i, j<span style="color: #008080;">;</span>
&nbsp;
    <span style="color: #0000ff;">while</span> <span style="color: #008000;">&#40;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
        x <span style="color: #000080;">=</span> y <span style="color: #000080;">=</span> rng<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #000040;">%</span> n<span style="color: #008080;">;</span>
&nbsp;
        z <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
        c <span style="color: #000080;">=</span> rng<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #000040;">%</span> n<span style="color: #008080;">;</span>
&nbsp;
        i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span>, j <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
        <span style="color: #0000ff;">for</span> <span style="color: #008000;">&#40;</span><span style="color: #008080;">;;</span> i<span style="color: #000040;">++</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
            x <span style="color: #000080;">=</span> <span style="color: #008000;">&#40;</span>x <span style="color: #000040;">*</span> x <span style="color: #000040;">%</span> n <span style="color: #000040;">+</span> c<span style="color: #008000;">&#41;</span> <span style="color: #000040;">%</span> n<span style="color: #008080;">;</span>
&nbsp;
            z <span style="color: #000080;">=</span> <span style="color: #008000;">&#40;</span>z <span style="color: #000040;">*</span> max<span style="color: #008000;">&#40;</span>y <span style="color: #000040;">-</span> x, x <span style="color: #000040;">-</span> y<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #000040;">%</span> n<span style="color: #008080;">;</span>
&nbsp;
            <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>x <span style="color: #000080;">==</span> y <span style="color: #0000ff;">or</span> <span style="color: #000040;">!</span>z<span style="color: #008000;">&#41;</span>
&nbsp;
                <span style="color: #0000ff;">break</span><span style="color: #008080;">;</span>
&nbsp;
            <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>i <span style="color: #000040;">%</span> <span style="color: #0000dd;">127</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span> <span style="color: #0000ff;">or</span> i <span style="color: #000080;">==</span> j<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
                g <span style="color: #000080;">=</span> __gcd<span style="color: #008000;">&#40;</span>n, z<span style="color: #008000;">&#41;</span><span style="color: #008080;">;</span>
&nbsp;
                <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>g <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">&#41;</span>
&nbsp;
                    <span style="color: #0000ff;">return</span> g<span style="color: #008080;">;</span>
&nbsp;
                <span style="color: #0000ff;">if</span> <span style="color: #008000;">&#40;</span>i <span style="color: #000080;">==</span> j<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&nbsp;
                    y <span style="color: #000080;">=</span> x<span style="color: #008080;">;</span>
&nbsp;
                    j <span style="color: #000080;">&lt;&lt;=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
&nbsp;
                <span style="color: #008000;">&#125;</span>
&nbsp;
            <span style="color: #008000;">&#125;</span>
&nbsp;
        <span style="color: #008000;">&#125;</span>
&nbsp;
    <span style="color: #008000;">&#125;</span>
&nbsp;
<span style="color: #008000;">&#125;</span></pre>

- 原根
	- 原根定义：满足 $1, g, g^2, g^3, \cdots, g^{phi(p)}$ 都不相同的 g。
	- 判断法：枚举 $\varphi(p)$ 的每个质因数，设当前枚举的是 c。如果 $a^{\frac{\varphi(p)}{c}} \equiv 1 \pmod p$，则 a 不是原根。
	- 原根一定小于 $n^{0.25 + \epsilon}$，求最小原根暴力枚举即可。
	- 原根存在条件：$(\exists p \in \text P \land p \mod 2 = 1, k \in \text Z), n = 2 \lor n = 4 \lor n = p^k \lor n = 2p^k$
- 二次剩余
	- https://oi-wiki.org/math/number-theory/quad-residue/
- 
